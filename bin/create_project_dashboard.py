import os

def create_portfolio_dashboard():
    """
    Scans the current directory for subdirectories (projects) and creates 
    a portfolio-style index.html file with linked project cards.
    """
    output_filename = "index.html"
    
    # 1. Filter for directories that contain an index.html file
    all_items = os.listdir('.')
    project_directories = sorted([
        item for item in all_items 
        if os.path.isdir(item) and os.path.exists(os.path.join(item, 'index.html'))
    ])

    # 2. Build the CSS for a cleaner, modern look
    css_style = """
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #f4f7f9; 
            margin: 0; 
            padding: 0; 
            color: #333;
        }
        .container { 
            max-width: 1200px; 
            margin: 40px auto; 
            padding: 0 20px; 
        }
        header { 
            text-align: center; 
            margin-bottom: 50px; 
            padding-bottom: 20px;
            border-bottom: 3px solid #007bff;
        }
        h1 { 
            color: #2c3e50; 
            font-size: 2.5em; 
            font-weight: 300;
        }
        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        .project-card {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            overflow: hidden;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        .card-content {
            padding: 20px;
        }
        h2 {
            margin-top: 0;
            color: #007bff;
            font-size: 1.5em;
        }
        p {
            color: #7f8c8d;
            font-size: 0.95em;
        }
    """

    # 3. Start building the HTML structure
    html_content = f"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Development Portfolio Dashboard</title>
    <style>
{css_style}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>My Web Projects Portfolio</h1>
            <p>A collection of front-end applications and components.</p>
        </header>

        <section class="project-grid">
"""
    
    # 4. Generate the project cards
    if not project_directories:
        html_content += """
            <div style="grid-column: 1 / -1; text-align: center; padding: 50px;">
                <p>No web project directories containing an 'index.html' were found.</p>
            </div>
        """
    else:
        for project_name in project_directories:
            # Simple title capitalization for a cleaner look
            display_name = project_name.replace('-', ' ').title()
            link_path = f"{project_name}/index.html"
            
            html_content += f"""
            <a href="{link_path}" class="project-card">
                <div class="card-content">
                    <h2>{display_name}</h2>
                    <p>Click to launch the **{display_name}** web application.</p>
                </div>
            </a>
"""

    # 5. Close the HTML tags
    html_content += """
        </section>

        <footer>
            <p style="text-align: center; margin-top: 50px; font-size: 0.8em; color: #95a5a6;">
                Dashboard generated by a Python script. | &copy; 2024
            </p>
        </footer>
    </div>
</body>
</html>
"""

    # 6. Write the content to the file
    try:
        with open(output_filename, 'w') as f:
            f.write(html_content.strip())
        
        print(f"Successfully created a portfolio-worthy dashboard: {output_filename}")
        print(f"Total projects linked: {len(project_directories)}")

    except IOError as e:
        print(f"Error writing to file: {e}")


if __name__ == "__main__":
    create_portfolio_dashboard()
